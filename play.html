<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Elden Pathsâ„¢ â€” Phase 28 (Gear + Effects)</title>
  <style>
    body { font-family: monospace; background: #f4f4f4; padding: 2em; }
    #out { white-space: pre-wrap; padding: 1em; background: #eee; border-radius: 6px; margin-bottom: 1em; max-width: 700px; }
    button { margin: 4px; }
    #mapModal {
      display: none;
      position: fixed;
      top: 10%;
      left: 50%;
      transform: translateX(-50%);
      background: #fff;
      padding: 1em;
      border: 2px solid #333;
      z-index: 1000;
    }
    #mapModal pre { font-size: 16px; line-height: 1.2em; cursor: pointer; }
  </style>
</head>
<body>

<h1>ğŸ“– Elden Pathsâ„¢</h1>
<div id="out">Loading...</div>

<button onclick="move('north')">â¬†ï¸ Go North</button>
<button onclick="move('south')">â¬‡ï¸ Go South</button>
<button onclick="move('east')">â¡ï¸ Go East</button>
<button onclick="move('west')">â¬…ï¸ Go West</button>
<button onclick="descend()">â› Descend</button>
<button onclick="ascend()">ğŸ›— Ascend</button><br>
<button onclick="fight()">âš”ï¸ Fight</button>
<button onclick="rest()">ğŸŒŠ Rest</button>
<button onclick="craft()">ğŸ”§ Craft</button>
<button onclick="shop()">ğŸª Shop</button>
<button onclick="renderMap()">ğŸ—º Show Map</button>
<button onclick="showInventory()">ğŸ’ Inventory</button>
<button onclick="showQuests()">ğŸ“œ Quests</button>
<button onclick="equipGear()">ğŸª– Equip</button>

<div id="mapModal">
  <pre id="mapGrid"></pre>
  <button onclick="document.getElementById('mapModal').style.display='none'">Close Map</button>
</div>

<script>
const name = prompt("Enter your name:");
let player = {
  name,
  tile: "0,0",
  z: 0,
  visited: [],
  inventory: [],
  hp: 10,
  maxHp: 10,
  str: 5,
  level: 1,
  xp: 0,
  gear: { weapon: null, armor: null, trinket: null },
  gold: 0,
  flags: {},
  quests: [],
  timeBelow: 0,
  time: { hour: 8, day: 1 },
  weather: "clear"
};

const gearData = {
  "Iron Sword": { slot: "weapon", str: 3 },
  "Leather Vest": { slot: "armor", maxHp: 2 },
  "Wolf Ring": { slot: "trinket", str: 1, maxHp: 1 }
};

function equipGear() {
  const choices = player.inventory.filter(i => gearData[i]);
  if (!choices.length) return alert("ğŸª– No equippable gear in inventory.");
  const item = prompt("Choose item to equip:\n" + choices.join("\n"));
  if (!gearData[item]) return alert("âŒ Invalid choice.");

  const data = gearData[item];
  const slot = data.slot;
  const old = player.gear[slot];
  if (old && gearData[old]) {
    const oldStats = gearData[old];
    if (oldStats.str) player.str -= oldStats.str;
    if (oldStats.maxHp) {
      player.maxHp -= oldStats.maxHp;
      if (player.hp > player.maxHp) player.hp = player.maxHp;
    }
  }

  player.gear[slot] = item;
  if (data.str) player.str += data.str;
  if (data.maxHp) player.maxHp += data.maxHp;

  alert(`ğŸª– Equipped ${item} in ${slot}.`);
  update("Gear updated.");
}

function updateTimeAndWeather() {
  player.time.hour += 1;
  if (player.time.hour >= 24) {
    player.time.hour = 0;
    player.time.day++;
  }
  const weatherOptions = ["clear", "rain", "fog", "storm", "snow"];
  if (Math.random() < 0.3) {
    player.weather = weatherOptions[Math.floor(Math.random() * weatherOptions.length)];
  }
  return `ğŸ•’ Day ${player.time.day}, ${player.time.hour}:00 â€” Weather: ${player.weather}`;
}

function update(log = "") {
  const timeLog = updateTimeAndWeather();
  const status =
    `ğŸ§ ${player.name} | â¤ï¸ ${player.hp}/${player.maxHp} | âš”ï¸ ${player.str} | ğŸŒŸ Lvl ${player.level}\n` +
    `ğŸ“ ${player.tile}, z=${player.z} | ğŸ’° ${player.gold}g\n` +
    `ğŸ’ ${player.inventory.join(', ') || 'Empty'}\n` +
    `ğŸª– Gear: ${Object.entries(player.gear).map(([s,v]) => `${s}:${v||"none"}`).join(' | ')}`;
  document.getElementById("out").textContent = `${log}\n${timeLog}\n\n${status}`;
}

// [rest of system assumed intact â€” movement, NPCs, quests, combat, etc.]
</script>

</body>
</html>
